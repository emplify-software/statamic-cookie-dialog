const k=document.querySelector("#cookie-dialog").shadowRoot;let g=!1,y;function S(){s.addEventListener("cancel",o=>{g||o.preventDefault()}),s.addEventListener("click",({target:o})=>{g&&o.nodeName==="DIALOG"&&o.close("dismiss")}),k.addEventListener("keydown",o=>{o.key==="Escape"&&!g&&o.preventDefault()}),s.addEventListener("close",w);const e=s.querySelector("#accept-all-btn"),t=s.querySelector("#save-preferences-btn");e.addEventListener("click",()=>{C(O(),!0),s.close()}),t.addEventListener("click",()=>{C(D()),s.close()})}function q(){const e=k.querySelectorAll("[data-cookie-group]");for(const t of e){const o=t.querySelector("input[type='checkbox']"),c=t.querySelectorAll("[data-cookie] input[type='checkbox']");for(const n of c)n.addEventListener("change",()=>{o.checked=[...c].some(u=>u.checked)});o.addEventListener("change",()=>{for(const n of c)n.checked=o.checked})}}function h(){G(),s.showModal(),s.classList.remove("es-opacity-0"),s.classList.remove("es-translate-y-10"),document.body.style.overflow="hidden"}function w(){s.classList.add("es-opacity-0"),s.classList.add("es-translate-y-10"),y=void 0,document.body.style.overflow="auto"}function p(){try{const e=JSON.parse(x("cookie-consent"));return e instanceof Array?e:null}catch{return null}}function A(e,t){var o,c,n,u;for(const i of document.querySelectorAll("template[data-requires-cookie], template[data-requires-cookie-group]")){const d=(o=i.dataset.requiresCookie)==null?void 0:o.split("|"),l=(c=i.dataset.requiresCookieGroup)==null?void 0:c.split("|"),f=!d||d.every(r=>e.includes(r)),a=!l||l.every(r=>t.includes(r));f&&a&&(i.before(i.content),i.remove())}for(const i of document.querySelectorAll("[data-denied-cookie], [data-denied-cookie-group]")){const d=(n=i.dataset.deniedCookie)==null?void 0:n.split("|"),l=(u=i.dataset.deniedCookieGroup)==null?void 0:u.split("|"),f=!d||d.every(r=>e.includes(r)),a=!l||l.every(r=>t.includes(r));f&&a&&i.remove()}}function O(){return v("[data-cookie]")}function D(){return v("[data-cookie-group]:has(input:checked) [data-cookie]:has(input:checked)")}function E(){return k.querySelector("[data-cookie-version]").dataset.cookieVersion}function L(){return!!k.querySelector("dialog[data-enabled]")}function v(e){const t=k.querySelectorAll(e);return Array.from(t).map(o=>o.dataset.cookie)}function j(){const e=k.querySelectorAll("[data-cookie-group]"),t={};for(const o of e){const c=o.dataset.cookieGroup,n={};t[c]=n;for(const u of o.querySelectorAll("[data-cookie]"))n[u.dataset.cookie]=!1}return t}function C(e,t=!1){var d,l;const o=m.allowedCookies,c=(d=p())==null?void 0:d.version,n=j();for(const[f,a]of Object.entries(n)){if(Object.keys(a).length===0){a["*"]=t||!!k.querySelector(`[data-cookie-group="${f}"]:has(:checked)`);continue}for(const r of Object.keys(a))e.includes(r)&&(a[r]=!0)}const u={cookies:n,timestamp:Date.now(),version:E()};N("cookie-consent",JSON.stringify(u),365);const i=m.allowedCookies;if(JSON.stringify(o)!==JSON.stringify(i)||c!=((l=p())==null?void 0:l.version)){y!=null?y&&location.reload():L()?o.filter(r=>!i.includes(r)).length>0&&location.reload():location.reload();const f=Object.entries(n).filter(([a,r])=>Object.values(r).every(b=>b)).map(([a,r])=>a);A(e,f)}}function N(e,t,o){let c="";if(o){const n=new Date;n.setTime(n.getTime()+o*24*60*60*1e3),c=`; expires=${n.toUTCString()}; SameSite=Lax`}t=encodeURIComponent(t),document.cookie=`${e}=${t||""}${c}; path=/`}function x(e){const t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]+)"));return t?decodeURIComponent(t[2]):null}function G(){const e=p();if(!e)return;const t=e.cookies;for(const[o,c]of Object.entries(t)){const n=k.querySelector(`[data-cookie-group="${o}"]`);if(!n)continue;const u=n.querySelector("input[type='checkbox']");for(const[i,d]of Object.entries(c)){const l=n.querySelector(`[data-cookie="${i}"] input[type='checkbox']`);l&&(l.checked=d)}u.checked=Object.values(c).some(i=>i)}}const s=k.querySelector("dialog");s&&s.hasAttribute("data-enabled")&&h();S();q();const m={showDialog:e=>{g=!0,y=e,h()},get allowedCookies(){const e=p();return e?Object.entries(e.cookies).flatMap(([t,o])=>Object.entries(o).filter(([c,n])=>n).map(([c,n])=>c)):[]},get allowedGroups(){const e=p();return e?Object.entries(e.cookies).filter(([t,o])=>Object.values(o).every(c=>c)).map(([t,o])=>t):[]},get cookiePreferences(){return p()}};globalThis.CookieDialog=m;
