const d=document.querySelector("#cookie-dialog-container").shadowRoot;let g=!1,y;function S(){s.addEventListener("cancel",e=>{g||e.preventDefault()}),s.addEventListener("click",({target:e})=>{g&&e.nodeName==="DIALOG"&&e.close("dismiss")}),d.addEventListener("keydown",e=>{e.key==="Escape"&&!g&&e.preventDefault()}),s.addEventListener("close",w);const o=s.querySelector("#accept-all-btn"),t=s.querySelector("#save-preferences-btn");o.addEventListener("click",()=>{C(O(),!0),s.close()}),t.addEventListener("click",()=>{C(D()),s.close()})}function q(){const o=d.querySelectorAll("[data-cookie-group]");for(const t of o){const e=t.querySelector("input[type='checkbox']"),n=t.querySelectorAll("[data-cookie] input[type='checkbox']");for(const c of n)c.addEventListener("change",()=>{e.checked=[...n].some(u=>u.checked)});e.addEventListener("change",()=>{for(const c of n)c.checked=e.checked})}}function h(){G(),s.showModal(),s.classList.remove("es-opacity-0"),s.classList.remove("es-translate-y-10"),document.body.style.overflow="hidden"}function w(){s.classList.add("es-opacity-0"),s.classList.add("es-translate-y-10"),y=void 0,document.body.style.overflow="auto"}function p(){try{return JSON.parse(x("cookie-consent"))}catch{return null}}function A(o,t){var e,n,c,u;for(const i of d.querySelectorAll("template[data-requires-cookie], template[data-requires-cookie-group]")){const k=(e=i.dataset.requiresCookie)==null?void 0:e.split("|"),l=(n=i.dataset.requiresCookieGroup)==null?void 0:n.split("|"),f=!k||k.every(r=>o.includes(r)),a=!l||l.every(r=>t.includes(r));f&&a&&(i.before(i.content),i.remove())}for(const i of d.querySelectorAll("[data-denied-cookie], [data-denied-cookie-group]")){const k=(c=i.dataset.deniedCookie)==null?void 0:c.split("|"),l=(u=i.dataset.deniedCookieGroup)==null?void 0:u.split("|"),f=!k||k.every(r=>o.includes(r)),a=!l||l.every(r=>t.includes(r));f&&a&&i.remove()}}function O(){return v("[data-cookie]")}function D(){return v("[data-cookie-group]:has(input:checked) [data-cookie]:has(input:checked)")}function E(){return d.querySelector("[data-cookie-version]").dataset.cookieVersion}function L(){return!!d.querySelector("dialog[data-enabled]")}function v(o){const t=d.querySelectorAll(o);return Array.from(t).map(e=>e.dataset.cookie)}function j(){const o=d.querySelectorAll("[data-cookie-group]"),t={};for(const e of o){const n=e.dataset.cookieGroup,c={};t[n]=c;for(const u of e.querySelectorAll("[data-cookie]"))c[u.dataset.cookie]=!1}return t}function C(o,t=!1){var k,l;const e=m.allowedCookies,n=(k=p())==null?void 0:k.version,c=j();for(const[f,a]of Object.entries(c)){if(Object.keys(a).length===0){a["*"]=t||!!d.querySelector(`[data-cookie-group="${f}"]:has(:checked)`);continue}for(const r of Object.keys(a))o.includes(r)&&(a[r]=!0)}const u={cookies:c,timestamp:Date.now(),version:E()};N("cookie-consent",JSON.stringify(u),365);const i=m.allowedCookies;if(JSON.stringify(e)!==JSON.stringify(i)||n!=((l=p())==null?void 0:l.version)){y!=null?y&&location.reload():L()?e.filter(r=>!i.includes(r)).length>0&&location.reload():location.reload();const f=Object.entries(c).filter(([a,r])=>Object.values(r).every(b=>b)).map(([a,r])=>a);A(o,f)}}function N(o,t,e){let n="";if(e){const c=new Date;c.setTime(c.getTime()+e*24*60*60*1e3),n=`; expires=${c.toUTCString()}; SameSite=Lax`}t=encodeURIComponent(t),document.cookie=`${o}=${t||""}${n}; path=/`}function x(o){const t=document.cookie.match(new RegExp("(^| )"+o+"=([^;]+)"));return t?decodeURIComponent(t[2]):null}function G(){const o=p();if(!o)return;const t=o.cookies;for(const[e,n]of Object.entries(t)){const c=d.querySelector(`[data-cookie-group="${e}"]`);if(!c)continue;const u=c.querySelector("input[type='checkbox']");for(const[i,k]of Object.entries(n)){const l=c.querySelector(`[data-cookie="${i}"] input[type='checkbox']`);l&&(l.checked=k)}u.checked=Object.values(n).some(i=>i)}}const s=d.querySelector("dialog#cookie-dialog");s&&s.hasAttribute("data-enabled")&&h();S();q();const m={showDialog:o=>{g=!0,y=o,h()},get allowedCookies(){const o=p();return o?Object.entries(o.cookies).flatMap(([t,e])=>Object.entries(e).filter(([n,c])=>c).map(([n,c])=>n)):[]},get allowedGroups(){const o=p();return o?Object.entries(o.cookies).filter(([t,e])=>Object.values(e).every(n=>n)).map(([t,e])=>t):[]},get cookiePreferences(){return p()}};globalThis.CookieDialog=m;
